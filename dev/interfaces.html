<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Userfacing API · Supposition.jl Documentation</title><meta name="title" content="Userfacing API · Supposition.jl Documentation"/><meta property="og:title" content="Userfacing API · Supposition.jl Documentation"/><meta property="twitter:title" content="Userfacing API · Supposition.jl Documentation"/><meta name="description" content="Documentation for Supposition.jl Documentation."/><meta property="og:description" content="Documentation for Supposition.jl Documentation."/><meta property="twitter:description" content="Documentation for Supposition.jl Documentation."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Supposition.jl Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Main Page</a></li><li><a class="tocitem" href="intro.html">Introduction to PBT</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="Examples/basic.html">Basic Usage</a></li><li><a class="tocitem" href="Examples/composition.html">Composing Generators</a></li><li><a class="tocitem" href="Examples/recursive.html">Recursive Generation</a></li><li><a class="tocitem" href="Examples/docalignment.html">Alignment of Documentation</a></li><li><a class="tocitem" href="Examples/target.html">Targeted Operation</a></li><li><a class="tocitem" href="Examples/stateful.html">Stateful Testing</a></li></ul></li><li><a class="tocitem" href="resources.html">PBT Resources</a></li><li><a class="tocitem" href="faq.html">FAQ</a></li><li class="is-active"><a class="tocitem" href="interfaces.html">Userfacing API</a><ul class="internal"><li><a class="tocitem" href="#Macro-based-API"><span>Macro-based API</span></a></li><li><a class="tocitem" href="#API-for-controlling-fuzzing"><span>API for controlling fuzzing</span></a></li><li><a class="tocitem" href="#Type-based-hooks"><span>Type-based hooks</span></a></li></ul></li><li><a class="tocitem" href="benchmarks.html">Benchmarks</a></li><li><a class="tocitem" href="api.html">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="interfaces.html">Userfacing API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="interfaces.html">Userfacing API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Seelengrab/Supposition.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Seelengrab/Supposition.jl/blob/main/docs/src/interfaces.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Userfacing-API"><a class="docs-heading-anchor" href="#Userfacing-API">Userfacing API</a><a id="Userfacing-API-1"></a><a class="docs-heading-anchor-permalink" href="#Userfacing-API" title="Permalink"></a></h1><p>Supposition.jl provides a few main interfaces to hook into with your code, as well as use during general usage of Supposition.jl. These are pretty robust and very minimal.</p><p>The interfaces mentioned on this page are intended for user-extension &amp; usage, in the manner described. Overloading the functions in a different way or assuming more of an interface than is guaranteed is not supported.</p><p>For the abstract-type based interfaces <code>ExampleDB</code> and <code>Possibility</code>, you can use the API provided by <a href="https://github.com/Seelengrab/RequiredInterfaces.jl">RequiredInterfaces.jl</a> to check for basic compliance, if you want to provide a custom implementation.</p><h2 id="Macro-based-API"><a class="docs-heading-anchor" href="#Macro-based-API">Macro-based API</a><a id="Macro-based-API-1"></a><a class="docs-heading-anchor-permalink" href="#Macro-based-API" title="Permalink"></a></h2><p>These macros are the main entryway most people should use, for both entry-level and advanced usage. <a href="interfaces.html#Supposition.@check"><code>@check</code></a> is responsible for interfacing with the internals of Supposition.jl, orchestrating the generation of examples &amp; reporting back to the testing framework.</p><p><a href="Examples/composition.html#@composed"><code>@composed</code></a> is the one-stop-shop for composing a new generator from a number of existing ones.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Supposition.@check" href="#Supposition.@check"><code>Supposition.@check</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@check [key=val]... function...</code></pre><p>The main way to declare &amp; run a property based test. Called like so:</p><pre><code class="language-julia-repl hljs">julia&gt; using Supposition, Supposition.Data

julia&gt; Supposition.@check [options...] function foo(a = Data.Text(Data.Characters(); max_len=10))
          length(a) &gt; 8
       end</code></pre><p>Supported options, passed as <code>key=value</code>:</p><ul><li><code>rng::Random.AbstractRNG</code>: Pass an RNG to use. Defaults to <code>Random.Xoshiro(rand(Random.RandomDevice(), UInt))</code>.</li><li><code>max_examples::Int</code>: The maximum number of generated examples that are passed to the property.</li><li><code>broken::Bool</code>: Mark a property that should pass but doesn&#39;t as broken, so that failures are not counted.</li><li><code>record::Bool</code>: Whether the result of the invocation should be recorded with any parent testsets.</li><li><code>db</code>: Either a Boolean (<code>true</code> uses a fallback database, <code>false</code> stops recording examples) or an <a href="interfaces.html#ExampleDB"><code>ExampleDB</code></a>.</li><li><code>config</code>: A <code>CheckConfig</code> object that will be used as a default for all previous options. Options that are passed explicitly to <code>@check</code> will override whatever is provided through <code>config</code>.</li></ul><p>The arguments to the given function are expected to be generator strategies. The names they are bound to are the names the generated object will have in the test. These arguments will be shown should the property fail!</p><p><strong>Extended help</strong></p><p><strong>Reusing existing properties</strong></p><p>If you already have a predicate defined, you can also use the calling syntax in <code>@check</code>. Here, the generator is passed purely positionally to the given function; no argument name is necessary.</p><pre><code class="language-julia-repl hljs">julia&gt; using Supposition, Supposition.Data

julia&gt; isuint8(x) = x isa UInt8

julia&gt; intgen = Data.Integers{UInt8}()

julia&gt; Supposition.@check isuint8(intgen)</code></pre><p><strong>Passing a custom RNG</strong></p><p>It is possible to optionally give a custom RNG object that will be used for random data generation. If none is given, <code>Xoshiro(rand(Random.RandomDevice(), UInt))</code> is used instead.</p><pre><code class="language-julia-repl hljs">julia&gt; using Supposition, Supposition.Data, Random

# use a custom Xoshiro instance
julia&gt; Supposition.@check rng=Xoshiro(1234) function foo(a = Data.Text(Data.Characters(); max_len=10))
          length(a) &gt; 8
       end</code></pre><div class="admonition is-warning"><header class="admonition-header">Hardware RNG</header><div class="admonition-body"><p>Be aware that you <em>cannot</em> pass a hardware RNG to <code>@check</code> directly. If you want to randomize based on hardware entropy, seed a copyable RNG like <code>Xoshiro</code> from your hardware RNG and pass that to <code>@check</code> instead. The RNG needs to be copyable for reproducibility.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Seelengrab/Supposition.jl/blob/b47811d9343b25c5d0d53a7c320e837b745a6a09/src/api.jl#L101-L163">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Supposition.@composed" href="#Supposition.@composed"><code>Supposition.@composed</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@composed</code></pre><p>A way to compose multiple <code>Possibility</code> into one, by applying a function.</p><p>The return type is inferred as a best-effort!</p><p>Used like so:</p><pre><code class="language-julia-repl hljs">julia&gt; using Supposition, Supposition.Data

julia&gt; text = Data.Text(Data.AsciiCharacters(); max_len=10)

julia&gt; gen = Supposition.@composed function foo(a = text, num=Data.Integers(0, 10))
              lpad(num, 2) * &quot;: &quot; * a
       end

julia&gt; example(gen)
&quot; 8:  giR2YL\rl&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Seelengrab/Supposition.jl/blob/b47811d9343b25c5d0d53a7c320e837b745a6a09/src/api.jl#L356-L377">source</a></section></article><h2 id="API-for-controlling-fuzzing"><a class="docs-heading-anchor" href="#API-for-controlling-fuzzing">API for controlling fuzzing</a><a id="API-for-controlling-fuzzing-1"></a><a class="docs-heading-anchor-permalink" href="#API-for-controlling-fuzzing" title="Permalink"></a></h2><p>These functions are intended for usage while testing, having various effects on the shrinking/fuzzing process. They are not intended to be part of a codebase permanently/in production.</p><p>The trailing exclamation mark serves as a reminder that this will, under the hood, modify the currently running testcase.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Supposition.target!-Tuple{Float64}" href="#Supposition.target!-Tuple{Float64}"><code>Supposition.target!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">target!(score)</code></pre><p>Update the currently running testcase to track the given score as its target.</p><p><code>score</code> must be <code>convert</code>ible to a <code>Float64</code>.</p><div class="admonition is-warning"><header class="admonition-header">Multiple Updates</header><div class="admonition-body"><p>This score can only be set once! Repeated calls will be ignored.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Callability</header><div class="admonition-body"><p>This can only be called while a testcase is currently being examined or an example for a <code>Possibility</code> is being actively generated. It is ok to call this inside of <code>@composed</code> or <code>@check</code>, as well as any functions only intended to be called from one of those places.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Seelengrab/Supposition.jl/blob/b47811d9343b25c5d0d53a7c320e837b745a6a09/src/api.jl#L410-L424">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Supposition.assume!-Tuple{Bool}" href="#Supposition.assume!-Tuple{Bool}"><code>Supposition.assume!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">assume!(precondition::Bool)</code></pre><p>If this precondition is not met, abort the test and mark the currently running testcase as invalid.</p><div class="admonition is-warning"><header class="admonition-header">Callability</header><div class="admonition-body"><p>This can only be called while a testcase is currently being examined or an example for a <code>Possibility</code> is being actively generated. It is ok to call this inside of <code>@composed</code> or <code>@check</code>, as well as any functions only intended to be called from one of those places.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Seelengrab/Supposition.jl/blob/b47811d9343b25c5d0d53a7c320e837b745a6a09/src/api.jl#L431-L440">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Supposition.Data.produce!-Tuple{Supposition.Data.Possibility}" href="#Supposition.Data.produce!-Tuple{Supposition.Data.Possibility}"><code>Supposition.Data.produce!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">produce!(p::Possibility{T}) -&gt; T</code></pre><p>Produces a value from the given <code>Possibility</code>, recording the required choices in the currently active <code>TestCase</code>.</p><div class="admonition is-warning"><header class="admonition-header">Callability</header><div class="admonition-body"><p>This can only be called while a testcase is currently being examined or an example for a <code>Possibility</code> is being actively generated. It is ok to call this inside of <code>@composed</code> or <code>@check</code>, as well as any functions only intended to be called from one of those places.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Seelengrab/Supposition.jl/blob/b47811d9343b25c5d0d53a7c320e837b745a6a09/src/api.jl#L456-L465">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Supposition.reject!" href="#Supposition.reject!"><code>Supposition.reject!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">reject!()</code></pre><p>Reject the current testcase as invalid, meaning the generated example should not be considered as producing a valid counterexample.</p><div class="admonition is-warning"><header class="admonition-header">Callability</header><div class="admonition-body"><p>This can only be called while a testcase is currently being examined or an example for a <code>Possibility</code> is being actively generated. It is ok to call this inside of <code>@composed</code> or <code>@check</code>, as well as any functions only intended to be called from one of those places.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Seelengrab/Supposition.jl/blob/b47811d9343b25c5d0d53a7c320e837b745a6a09/src/api.jl#L443-L453">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Supposition.DEFAULT_CONFIG" href="#Supposition.DEFAULT_CONFIG"><code>Supposition.DEFAULT_CONFIG</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">DEFAULT_CONFIG</code></pre><p>A <code>ScopedValue</code> holding the <a href="api.html#Supposition.CheckConfig-api"><code>CheckConfig</code></a> that will be used by default &amp; as a fallback.</p><p>Currently uses these values:</p><ul><li><code>rng</code>: <code>Random.Xoshiro(rand(Random.RandomDevice(), UInt))</code></li><li><code>max_examples</code>: <code>10_000</code></li><li><code>record</code>: <code>true</code></li><li><code>verbose</code>: <code>false</code></li><li><code>broken</code>: <code>false</code></li><li><code>buffer_size</code>: <code>100_000</code></li></ul><p><a href="interfaces.html#Supposition.@check"><code>@check</code></a> will use a <em>new</em> instance of <code>Random.Xoshiro</code> by itself.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Seelengrab/Supposition.jl/blob/b47811d9343b25c5d0d53a7c320e837b745a6a09/src/Supposition.jl#L31-L46">source</a></section></article><h2 id="Type-based-hooks"><a class="docs-heading-anchor" href="#Type-based-hooks">Type-based hooks</a><a id="Type-based-hooks-1"></a><a class="docs-heading-anchor-permalink" href="#Type-based-hooks" title="Permalink"></a></h2><p>These are hooks for users to provide custom implementations of certain parts of Supposition.jl. Follow their contracts precisely if you implement your own.</p><h3 id="Possibility{T}"><a class="docs-heading-anchor" href="#Possibility{T}"><code>Possibility{T}</code></a><a id="Possibility{T}-1"></a><a class="docs-heading-anchor-permalink" href="#Possibility{T}" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Supposition.Data.Possibility" href="#Supposition.Data.Possibility"><code>Supposition.Data.Possibility</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Possibility{T}</code></pre><p>Abstract supertype for all generators. The <code>T</code> type parameter describes the kinds of objects generated by this integrated shrinker.</p><p>Required methods:</p><ul><li><code>produce!(::TestCase, ::P) where P &lt;: Possibility</code></li></ul><p>Fallback definitions:</p><ul><li><code>postype(::Possibility{T}) -&gt; Type{T}</code></li><li><code>example(::Possibility{T}) -&gt; T</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Seelengrab/Supposition.jl/blob/b47811d9343b25c5d0d53a7c320e837b745a6a09/src/data.jl#L42-L56">source</a></section></article><h3 id="ExampleDB"><a class="docs-heading-anchor" href="#ExampleDB"><code>ExampleDB</code></a><a id="ExampleDB-1"></a><a class="docs-heading-anchor-permalink" href="#ExampleDB" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Supposition.ExampleDB" href="#Supposition.ExampleDB"><code>Supposition.ExampleDB</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ExampleDB</code></pre><p>An abstract type representing a database of previous counterexamples.</p><p>Required methods:</p><ul><li><code>records(::ExampleDB)</code>: Returns an iterable of all currently recorded counterexamples.</li><li><code>record!(::ExampleDB, key, value)</code>: Record the counterexample <code>value</code> under the key <code>key</code>.</li><li><code>retrieve(::ExampleDB, key)::Option</code>: Retrieve the previously recorded counterexample stored under <code>key</code>.     Return <code>nothing</code> if no counterexample was stored under that key.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Seelengrab/Supposition.jl/blob/b47811d9343b25c5d0d53a7c320e837b745a6a09/src/types.jl#L44-L55">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="faq.html">« FAQ</a><a class="docs-footer-nextpage" href="benchmarks.html">Benchmarks »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Monday 4 March 2024 22:48">Monday 4 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
